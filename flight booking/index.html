<!DOCTYPE html>
<html>

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    <div class="container mt-5">
        <div class="card p-4 shadow-sm">
            <h2 class="mb-4">Book Your Flight</h2>
            <form id="flight-search-form">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label for="origin" class="form-label">Flying From</label>
                        <input type="text" class="form-control" id="origin" placeholder="City or Airport" required>
                    </div>
                    <div class="col-md-6">
                        <label for="destination" class="form-label">Flying To</label>
                        <input type="text" class="form-control" id="destination" placeholder="City or Airport" required>
                    </div>

                    <div class="col-md-6">
                        <label for="departure-date" class="form-label">Departure Date</label>
                        <input type="date" class="form-control" id="departure-date" required>
                    </div>

                    <div class="col-md-6">
                        <label for="travel-class" class="form-label">Travel Class</label>
                        <select class="form-select" id="travel-class">
                            <option value="Economy">Economy</option>
                            <option value="Premium Economy">Premium Economy</option>
                            <option value="Business Class">Business Class</option>
                            <option value="First Class">First Class</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label for="adults" class="form-label">Adults (12+)</label>
                        <input type="number" class="form-control" id="adults" value="1" min="1" max="9" required>
                    </div>
                    <div class="col-md-6">
                        <label for="children" class="form-label">Children (2-11)</label>
                        <input type="number" class="form-control" id="children" value="0" min="0" max="9">
                    </div>

                    <div class="col-12 mt-4">
                        <button type="submit" class="btn btn-primary w-100" id="btn">Search Flights</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="container mt-5" id="load"></div>

    <script>
        const flightInfo = [
            { flightId: 1, flight: "Indigo", orgin: "Ahmedabad", destination: "Mumbai", date: "2025-11-08", priceforAdult: 3500, priceforChildren: 1400 },
            { flightId: 2, flight: "Asia Air", orgin: "Banglore", destination: "Delhi", date: "2025-01-20", priceforAdult: 2500, priceforChildren: 1400 },
            { flightId: 3, flight: "Indigo", orgin: "Delhi", destination: "Mumbai", date: "2025-12-25", priceforAdult: 2900, priceforChildren: 1200 },
            { flightId: 4, flight: "Indigo", orgin: "Banglore", destination: "Mumbai", date: "2026-12-02", priceforAdult: 2700, priceforChildren: 1400 },
            { flightId: 5, flight: "Indigo", orgin: "Ahmedabad", destination: "Rajkot", date: "2025-11-20", priceforAdult: 2400, priceforChildren: 1400 },
            { flightId: 6, flight: "Asia Air", orgin: "Ahmedabad", destination: "Mumbai", date: "2025-11-08", priceforAdult: 2800, priceforChildren: 1000 },
            { flightId: 7, flight: "Indigo", orgin: "Ahmedabad", destination: "Mumbai", date: "2025-12-12", priceforAdult: 2500, priceforChildren: 900 },
            { flightId: 8, flight: "Indigo", orgin: "Ahmedabad", destination: "Mumbai", date: "2025-12-17", priceforAdult: 2000, priceforChildren: 780 }
        ];

        document.getElementById("flight-search-form").addEventListener("submit", function (event) {
            event.preventDefault();
            loadFlights();
        });

        function loadFlights() {
            const orgin = document.getElementById("origin").value.trim().toLowerCase();
            const destination = document.getElementById("destination").value.trim().toLowerCase();
            const noOfAdult = parseInt(document.getElementById("adults").value);
            const noOfChild = parseInt(document.getElementById("children").value);
            const dateoftravel = document.getElementById("departure-date").value;
            const travelClass = document.getElementById("travel-class").value;

            const searchedFlight = flightInfo.filter(f =>
                f.orgin.toLowerCase() === orgin &&
                f.destination.toLowerCase() === destination &&
                f.date === dateoftravel
            );

            displaydata(searchedFlight, noOfAdult, noOfChild, travelClass);
        }

        function displaydata(list, noOfAdult, noOfChild, travelClass) {
            if (list.length === 0) {
                document.getElementById("load").innerHTML = `<h2 class="mb-3 text-center text-danger">No Flights Found</h2>`;
                return;
            }

            let html = `
        <h2 class="mb-3 text-center">Available Flights</h2>
        <div class="table-responsive">
          <table class="table table-hover table-striped">
            <thead>
              <tr>
                <th>Airline</th>
                <th>Departure</th>
                <th>Arrival</th>
                <th>Date</th>
                <th>Total Price</th>
                <th>Book</th>
              </tr>
            </thead>
            <tbody>`;

            list.forEach(f => {
                const totalPrice = (noOfAdult * f.priceforAdult) + (noOfChild * f.priceforChildren);
                html += `
          <tr>
            <td>${f.flight}</td>
            <td>${f.orgin}</td>
            <td>${f.destination}</td>
            <td>${f.date}</td>
            <td>â‚¹${totalPrice}</td>
            <td><button class="btn btn-primary btn-sm book-btn" 
                        data-flight='${JSON.stringify({ ...f, totalPrice, noOfAdult, noOfChild, travelClass })}'>
                        Book Now
                </button>
            </td>
          </tr>`;
            });

            html += `</tbody></table></div>`;
            document.getElementById("load").innerHTML = html;

            document.querySelectorAll(".book-btn").forEach(btn => {
                btn.addEventListener("click", function () {

                    const flightData = JSON.parse(this.getAttribute("data-flight"));
                    localStorage.setItem('selectedFlight', JSON.stringify(flightData));
                    window.location.href = "passengerdetail.html";

                });
            });
        }
    </script>

</body>

</html>